# -*- coding: utf8 -*-
from __future__ import print_function
from __future__ import division
from pymongo import MongoClient
from bson import json_util
from datetime import datetime
import pytz, time
import cfscrape
from colorama import init
from colorama import Fore, Back, Style
init()

exchange = 'Kraken'
bookTickerURL = "https://api.kraken.com/0/public/AssetPairs"
scraper = cfscrape.create_scraper()
client = MongoClient()
db = client.kraken
data_json = ''
interval = 10

d = datetime.now(tz=pytz.utc)
dFormatted = Fore.GREEN + d.strftime('%d/%m/%Y %H:%M:%S') + Style.RESET_ALL
print("{} {} assetPairs started...".format(dFormatted, exchange))

data_json = {"_id":'',"timestamp":'',"valid":'false',"error":[],"result":{}}

oldData_json = """{"error":[],"result":{"BCHEUR":{"altname":"BCHEUR","aclass_base":"currency","base":"BCH","aclass_quote":"currency","quote":"ZEUR","lot":"unit","pair_decimals":1,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"BCHUSD":{"altname":"BCHUSD","aclass_base":"currency","base":"BCH","aclass_quote":"currency","quote":"ZUSD","lot":"unit","pair_decimals":1,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"BCHXBT":{"altname":"BCHXBT","aclass_base":"currency","base":"BCH","aclass_quote":"currency","quote":"XXBT","lot":"unit","pair_decimals":5,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"DASHEUR":{"altname":"DASHEUR","aclass_base":"currency","base":"DASH","aclass_quote":"currency","quote":"ZEUR","lot":"unit","pair_decimals":3,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"DASHUSD":{"altname":"DASHUSD","aclass_base":"currency","base":"DASH","aclass_quote":"currency","quote":"ZUSD","lot":"unit","pair_decimals":3,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"DASHXBT":{"altname":"DASHXBT","aclass_base":"currency","base":"DASH","aclass_quote":"currency","quote":"XXBT","lot":"unit","pair_decimals":5,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"EOSETH":{"altname":"EOSETH","aclass_base":"currency","base":"EOS","aclass_quote":"currency","quote":"XETH","lot":"unit","pair_decimals":6,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"EOSXBT":{"altname":"EOSXBT","aclass_base":"currency","base":"EOS","aclass_quote":"currency","quote":"XXBT","lot":"unit","pair_decimals":7,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"GNOETH":{"altname":"GNOETH","aclass_base":"currency","base":"GNO","aclass_quote":"currency","quote":"XETH","lot":"unit","pair_decimals":4,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"GNOXBT":{"altname":"GNOXBT","aclass_base":"currency","base":"GNO","aclass_quote":"currency","quote":"XXBT","lot":"unit","pair_decimals":5,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"USDTZUSD":{"altname":"USDTUSD","aclass_base":"currency","base":"USDT","aclass_quote":"currency","quote":"ZUSD","lot":"unit","pair_decimals":4,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[2],"leverage_sell":[2],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XETCXETH":{"altname":"ETCETH","aclass_base":"currency","base":"XETC","aclass_quote":"currency","quote":"XETH","lot":"unit","pair_decimals":6,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[2],"leverage_sell":[2],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XETCXXBT":{"altname":"ETCXBT","aclass_base":"currency","base":"XETC","aclass_quote":"currency","quote":"XXBT","lot":"unit","pair_decimals":6,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[2,3],"leverage_sell":[2,3],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XETCZEUR":{"altname":"ETCEUR","aclass_base":"currency","base":"XETC","aclass_quote":"currency","quote":"ZEUR","lot":"unit","pair_decimals":3,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[2],"leverage_sell":[2],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XETCZUSD":{"altname":"ETCUSD","aclass_base":"currency","base":"XETC","aclass_quote":"currency","quote":"ZUSD","lot":"unit","pair_decimals":3,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[2],"leverage_sell":[2],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XETHXXBT":{"altname":"ETHXBT","aclass_base":"currency","base":"XETH","aclass_quote":"currency","quote":"XXBT","lot":"unit","pair_decimals":5,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[2,3,4,5],"leverage_sell":[2,3,4,5],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XETHXXBT.d":{"altname":"ETHXBT.d","aclass_base":"currency","base":"XETH","aclass_quote":"currency","quote":"XXBT","lot":"unit","pair_decimals":6,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XETHZCAD":{"altname":"ETHCAD","aclass_base":"currency","base":"XETH","aclass_quote":"currency","quote":"ZCAD","lot":"unit","pair_decimals":2,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XETHZCAD.d":{"altname":"ETHCAD.d","aclass_base":"currency","base":"XETH","aclass_quote":"currency","quote":"ZCAD","lot":"unit","pair_decimals":5,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XETHZEUR":{"altname":"ETHEUR","aclass_base":"currency","base":"XETH","aclass_quote":"currency","quote":"ZEUR","lot":"unit","pair_decimals":2,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[2,3,4,5],"leverage_sell":[2,3,4,5],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XETHZEUR.d":{"altname":"ETHEUR.d","aclass_base":"currency","base":"XETH","aclass_quote":"currency","quote":"ZEUR","lot":"unit","pair_decimals":5,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XETHZGBP":{"altname":"ETHGBP","aclass_base":"currency","base":"XETH","aclass_quote":"currency","quote":"ZGBP","lot":"unit","pair_decimals":2,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XETHZGBP.d":{"altname":"ETHGBP.d","aclass_base":"currency","base":"XETH","aclass_quote":"currency","quote":"ZGBP","lot":"unit","pair_decimals":5,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XETHZJPY":{"altname":"ETHJPY","aclass_base":"currency","base":"XETH","aclass_quote":"currency","quote":"ZJPY","lot":"unit","pair_decimals":0,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XETHZJPY.d":{"altname":"ETHJPY.d","aclass_base":"currency","base":"XETH","aclass_quote":"currency","quote":"ZJPY","lot":"unit","pair_decimals":3,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XETHZUSD":{"altname":"ETHUSD","aclass_base":"currency","base":"XETH","aclass_quote":"currency","quote":"ZUSD","lot":"unit","pair_decimals":2,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[2,3,4,5],"leverage_sell":[2,3,4,5],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XETHZUSD.d":{"altname":"ETHUSD.d","aclass_base":"currency","base":"XETH","aclass_quote":"currency","quote":"ZUSD","lot":"unit","pair_decimals":5,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XICNXETH":{"altname":"ICNETH","aclass_base":"currency","base":"XICN","aclass_quote":"currency","quote":"XETH","lot":"unit","pair_decimals":6,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XICNXXBT":{"altname":"ICNXBT","aclass_base":"currency","base":"XICN","aclass_quote":"currency","quote":"XXBT","lot":"unit","pair_decimals":6,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XLTCXXBT":{"altname":"LTCXBT","aclass_base":"currency","base":"XLTC","aclass_quote":"currency","quote":"XXBT","lot":"unit","pair_decimals":6,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XLTCZEUR":{"altname":"LTCEUR","aclass_base":"currency","base":"XLTC","aclass_quote":"currency","quote":"ZEUR","lot":"unit","pair_decimals":2,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XLTCZUSD":{"altname":"LTCUSD","aclass_base":"currency","base":"XLTC","aclass_quote":"currency","quote":"ZUSD","lot":"unit","pair_decimals":2,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XMLNXETH":{"altname":"MLNETH","aclass_base":"currency","base":"XMLN","aclass_quote":"currency","quote":"XETH","lot":"unit","pair_decimals":5,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XMLNXXBT":{"altname":"MLNXBT","aclass_base":"currency","base":"XMLN","aclass_quote":"currency","quote":"XXBT","lot":"unit","pair_decimals":6,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XREPXETH":{"altname":"REPETH","aclass_base":"currency","base":"XREP","aclass_quote":"currency","quote":"XETH","lot":"unit","pair_decimals":5,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[2],"leverage_sell":[2],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XREPXXBT":{"altname":"REPXBT","aclass_base":"currency","base":"XREP","aclass_quote":"currency","quote":"XXBT","lot":"unit","pair_decimals":6,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[2],"leverage_sell":[2],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XREPZEUR":{"altname":"REPEUR","aclass_base":"currency","base":"XREP","aclass_quote":"currency","quote":"ZEUR","lot":"unit","pair_decimals":3,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[2],"leverage_sell":[2],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXBTZCAD":{"altname":"XBTCAD","aclass_base":"currency","base":"XXBT","aclass_quote":"currency","quote":"ZCAD","lot":"unit","pair_decimals":1,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXBTZCAD.d":{"altname":"XBTCAD.d","aclass_base":"currency","base":"XXBT","aclass_quote":"currency","quote":"ZCAD","lot":"unit","pair_decimals":3,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXBTZEUR":{"altname":"XBTEUR","aclass_base":"currency","base":"XXBT","aclass_quote":"currency","quote":"ZEUR","lot":"unit","pair_decimals":1,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[2,3,4,5],"leverage_sell":[2,3,4,5],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXBTZEUR.d":{"altname":"XBTEUR.d","aclass_base":"currency","base":"XXBT","aclass_quote":"currency","quote":"ZEUR","lot":"unit","pair_decimals":2,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXBTZGBP":{"altname":"XBTGBP","aclass_base":"currency","base":"XXBT","aclass_quote":"currency","quote":"ZGBP","lot":"unit","pair_decimals":1,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXBTZGBP.d":{"altname":"XBTGBP.d","aclass_base":"currency","base":"XXBT","aclass_quote":"currency","quote":"ZGBP","lot":"unit","pair_decimals":3,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXBTZJPY":{"altname":"XBTJPY","aclass_base":"currency","base":"XXBT","aclass_quote":"currency","quote":"ZJPY","lot":"unit","pair_decimals":0,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXBTZJPY.d":{"altname":"XBTJPY.d","aclass_base":"currency","base":"XXBT","aclass_quote":"currency","quote":"ZJPY","lot":"unit","pair_decimals":1,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXBTZUSD":{"altname":"XBTUSD","aclass_base":"currency","base":"XXBT","aclass_quote":"currency","quote":"ZUSD","lot":"unit","pair_decimals":1,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[2,3,4,5],"leverage_sell":[2,3,4,5],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXBTZUSD.d":{"altname":"XBTUSD.d","aclass_base":"currency","base":"XXBT","aclass_quote":"currency","quote":"ZUSD","lot":"unit","pair_decimals":3,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXDGXXBT":{"altname":"XDGXBT","aclass_base":"currency","base":"XXDG","aclass_quote":"currency","quote":"XXBT","lot":"unit","pair_decimals":8,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXLMXXBT":{"altname":"XLMXBT","aclass_base":"currency","base":"XXLM","aclass_quote":"currency","quote":"XXBT","lot":"unit","pair_decimals":8,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXMRXXBT":{"altname":"XMRXBT","aclass_base":"currency","base":"XXMR","aclass_quote":"currency","quote":"XXBT","lot":"unit","pair_decimals":6,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[2,3],"leverage_sell":[2,3],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXMRZEUR":{"altname":"XMREUR","aclass_base":"currency","base":"XXMR","aclass_quote":"currency","quote":"ZEUR","lot":"unit","pair_decimals":2,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[2],"leverage_sell":[2],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXMRZUSD":{"altname":"XMRUSD","aclass_base":"currency","base":"XXMR","aclass_quote":"currency","quote":"ZUSD","lot":"unit","pair_decimals":2,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[2],"leverage_sell":[2],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXRPXXBT":{"altname":"XRPXBT","aclass_base":"currency","base":"XXRP","aclass_quote":"currency","quote":"XXBT","lot":"unit","pair_decimals":8,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXRPZEUR":{"altname":"XRPEUR","aclass_base":"currency","base":"XXRP","aclass_quote":"currency","quote":"ZEUR","lot":"unit","pair_decimals":5,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XXRPZUSD":{"altname":"XRPUSD","aclass_base":"currency","base":"XXRP","aclass_quote":"currency","quote":"ZUSD","lot":"unit","pair_decimals":5,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XZECXXBT":{"altname":"ZECXBT","aclass_base":"currency","base":"XZEC","aclass_quote":"currency","quote":"XXBT","lot":"unit","pair_decimals":5,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XZECZEUR":{"altname":"ZECEUR","aclass_base":"currency","base":"XZEC","aclass_quote":"currency","quote":"ZEUR","lot":"unit","pair_decimals":3,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40},"XZECZUSD":{"altname":"ZECUSD","aclass_base":"currency","base":"XZEC","aclass_quote":"currency","quote":"ZUSD","lot":"unit","pair_decimals":2,"lot_decimals":8,"lot_multiplier":1,"leverage_buy":[],"leverage_sell":[],"fees":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fees_maker":[[0,0],[50000,0],[100000,0],[250000,0],[500000,0],[1000000,0],[2500000,0],[5000000,0],[10000000,0]],"fee_volume_currency":"ZUSD","margin_call":80,"margin_stop":40}}}"""

sayfa = ''

while True:
    d = datetime.now(tz=pytz.utc)
    ts = time.time()
    valid = 'true'
    if (not d.minute % interval):
        print ("{} Interval".format(d.strftime('%d/%m/%Y %H:%M:%S')))
        try:
            response = scraper.get(bookTickerURL).content
            response = response.replace('.d', '^d')
            temp_data_json = json_util.loads(response)
            data_json['error'] = temp_data_json['error']
            data_json['result'] = temp_data_json['result']
        except:
            status = 0
            print('{} assetPairs api hatasÄ±'.format(exchange))

        if 'ETHXBT' not in response:
            valid = 'false'
            data_json = oldData_json
            data_json['valid'] = valid
            dFormatted = Fore.RED + d.strftime('%d/%m/%Y %H:%M:%S') + Style.RESET_ALL
            print('Data invalid!')

        data_json['_id'] = int(ts)
        data_json['timestamp'] = d
        data_json['valid'] = valid
        result = db['assetPairs'].insert_one(data_json)

        dFormatted = Fore.GREEN + d.strftime('%d/%m/%Y %H:%M:%S') + Style.RESET_ALL
        print(
            "{} Inserted_id: {}".format(dFormatted, result.inserted_id))

        print('{} assetPairs done...'.format(exchange))
        oldData_json = data_json
        client.close()
        time.sleep(61)
    time.sleep(0.9)
